language: node_js
node_js:
  - '8'
env:
  global:
    # cozy-bot GITHUB_TOKEN
    # to generate yours : travis encrypt GITHUB_TOKEN=<your_GITHUB_TOKEN>
    - secure: "A3545WKk4YWMGXxoorFfb0ZpSPwqB0YnTkrzCyJ1ZArEMNKngvLEHb5wesqRsBgsXXNBdUHW3ZnFumgjOwnWprnTg4wXHK0JXVZxFAz+Eqez+1jwd/eRqeaiIMP/hBxJuw5dRstnX9ZPufWrMyTt0mLXt8Np2JqAVXHYnRTydeYV9BPHRFFiaybUYw3hdomYyrM1Fby+6UuEkEqmipBIqpoCncUcpacRjnXPP9mQe9MplURDv17sP9SviZYN0XBk8K9X99USEGfIEfy7EGuVZ6teQ5QB9YNY4tVGYXy+7P8Rx4qDCAejB4i7nm9sYxkRvOds4VgX8aqGHO9IGL8scoUIHcn2RH5eIuSuVf2Eu4aewWebym8XCFCIAiTvJXRmZqcT8zTjqoDc8DKSm795VKyTJ+fHPd4XSmWjBaafxy7wyLy5ypOQuviIV+ccOZQy/urcVzRsZ61XZRBGK7kVvoodH4EjUb56xNpPNUzlCFlQ4v4ixp00uD79bQ2rTJ+/yZkgoD7Wa2lwUdlB3JrNijDVICZuqKacxDRpVu1SrnstEXMqB7antUJZouLNQ1bAVx0rKDyjJwUkmZMzEdhtAWr1iBfPsdtn/YB9xY2DeEK37wU9POqhOtabsiu7yvGISncpiprszybeNnCTCWIE2oyEPMhF/WUs8tCizkheI0E="
    # REGISTRY_TOKEN
    - secure: TX5mIMnEJrJO7rKaURVdkTZVfBvtopDjp1zkztSE2JSEDjrSxNjacuGKjb2WTfXijraFDazqGjhSy1mZLQYEF4mHFRcKGGdDBMwgc45VBni6zq6Z70JeYaEiAn5lvbcdLo8LC+mY13Pk/X0TRqNlzVObCRrz3+H/J8x3WF1DVsOC1pMLRJZXxoieRXl9mgzk10nHC6VaqP05PmZS9t4/nUMlR+xUxLfHIasYW/UGgYqVLm/ua8B9vLSy/3dyrDPm7KmCvWZI5JlI4lcaLH9IhTCGDm74/gvauqwBxtSxm8caOLylBAZ427B1cA75uGAIGN0aoOl/apTEt+/fi+7QQEpa/+X6fYaojOfDC1HmcuUWXviGMg1L2bZBMs26rgxymFFaUB+I+BgXCJPXOQkIfMcqETD3pET/32QsTwC4L3iTqWc3RFEvrdQNi/9jy2O3w5h7dp4UmUH7zClS53jUAPipl27Q6I6M1lNXd5U1f7w0F17HQAo6MOvAZm02y9mic8FxxTDmAJL+95sx75D7HVCHHTpAgOUm5tYGeWSjBARvQ6yN7XYQHqPpFMpukf4kmpoTfYVY/AvYMU4yETaCEzXYzfrnMe5MClZCE/OWY+NNbOOhM3q0D1bLOyYik0xPCtCfIHe2eBudaxMTfKjgThHoxckGsyYn1syL9Z1ycIU=
cache:
  yarn: true
  directories:
    - node_modules
script:
  - yarn lint
  - yarn build
deploy:
  - provider: script
    repo: konnectors/cozy-konnector-pajemploi
    skip-cleanup: true
    script: DEPLOY_BRANCH=build && yarn deploy && yarn cozyPublish
    on:
      branch: master
  - provider: script
    repo: konnectors/cozy-konnector-pajemploi
    skip-cleanup: true
    script: DEPLOY_BRANCH=latest && yarn deploy && yarn cozyPublish
    on:
      branch: prod
